!function(t){var e,s=document.getElementById("msgPanelBody"),n=document.getElementById("inputFld"),o=document.getElementById("sendButton"),i='<div class="row alert"> \t\t\t        <div class="msg alert"> \t\t\t            <p><i class="fa fa-lightbulb-o"></i> {msg}</p> \t\t\t        </div>\t\t\t    </div>',c='<div class="row they">\t\t\t\t\t<div class="msg they">\t\t\t\t\t\t<p><strong>Stranger:</strong></p>\t\t\t\t\t\t<div>{msg}</div>\t\t\t\t\t</div>\t\t\t\t</div>',l='<div class="row me">\t\t    <div class="msg me">\t\t        <p><strong>Me:</strong></p>\t\t        <div>{msg}</div>\t\t    </div>\t\t</div>',d=16,a=13,r=10,g={flags:{holding:{shift:!1}},render:{message:function(t,e){if(t&&e){-1!=e.indexOf("\n")?e="<p>"+(e=e.split("\n")).join("</p><p>")+"</p>":(console.log("Tem \n"),e="<p>"+e+"</p>");var n=t.replace("{msg}",e),o=$(n);$(s).append(o)}},msg:{me:function(t){g.render.message(l,t)},they:function(t){g.render.message(c,t)},alert:function(t){g.render.message(i,t)}}},scroll:{top:function(){s.scrollTop=0},bottom:function(){s.scrollTop=s.scrollHeight}},socket:{_namespace:"/chat",connect:function(){console.log("Initializing socket."),e=io.connect("http://"+document.domain+":"+location.port+this._namespace),console.log("Socket up: ",e)},send:function(t){e.send(t)},receive:function(t){g.render.msg.they(t),g.scroll.bottom()},alert:function(t){console.log("alert: ",t),g.render.msg.alert(t)}},onKeyUp:function(t){if(t.which==d&&(g.flags.holding.shift=!1),(t.which==a||t.which==r)&&!g.flags.holding.shift)return t.preventDefault(),void g.sendMessage()},onKeyDown:function(t){t.which==d&&(g.flags.holding.shift=!0)},sendMessage:function(){var t=n.value;n.value="",g.render.msg.me(t),g.socket.send(t),g.scroll.bottom()},sendButtonClicked:function(){g.sendMessage()},initialize:function(){console.log("Initializing."),n.addEventListener("keydown",g.onKeyDown),n.addEventListener("keyup",g.onKeyUp),o.addEventListener("click",g.sendButtonClicked),g.socket.connect(),e.on("message",g.socket.receive),e.on("alert",function(t){g.socket.alert(t.msg),g.scroll.bottom()})}};g.initialize(),t.expose={Chat:g,sio:e}}(window);